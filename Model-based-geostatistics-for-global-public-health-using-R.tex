% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
]{krantz}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\renewcommand{\and}{\\}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{exercise}{Exercise}[chapter]
\newtheorem{example}{Example}[chapter]
\newtheorem{definition}{Definition}[chapter]
%%\newtheorem{proof}{Proof}
\newenvironment{proof}[1][Proof]%
%  \topsep6\p@\@plus6\p@ \trivlist
{\par\addvspace{6pt}\normalfont {\bfseries #1}\hskip\labelsep\ignorespaces\itshape}
{\par\addvspace{6pt}}
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Model-based geostatistics for global public health using R},
  pdfauthor={Emanuele Giorgi; Claudio Fronterre},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Model-based geostatistics for global public health using R}
\author{Emanuele Giorgi \and Claudio Fronterre}
\date{3/3/23}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[borderline west={3pt}{0pt}{shadecolor}, enhanced, frame hidden, sharp corners, boxrule=0pt, breakable, interior hidden]}{\end{tcolorbox}}\fi

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

\markboth{Preface}{Preface}

Its companion book ``Model-based geostatistical for global public
health'\,' by Diggle (2019) is a strongly recommended complementary
read, as you work your way through this book.

\bookmarksetup{startatroot}

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

The book provides shows how to carry out model-based geostatistical
analysis of public health data using the \texttt{RiskMap} R package. In
this introductory chapter, we explain what are the pre-requisites for
using this book and its learning objectives. We also explain what
software should be installed and how. Finally, we give a brief overview
of the class of models covered in this book, and the examples that will
be used to illustrate the methods and use of software.

\hypertarget{objectives-of-this-book}{%
\section{Objectives of this book}\label{objectives-of-this-book}}

The overall aim of this book is to provide you with the skills to
perform a geostatistical analysis of a data-set using the R software
environment. As you work your way through the book, you will learn to:

\begin{itemize}
\tightlist
\item
  explore geo-statistical data-sets using graphical procedures and
  summary statitics;
\item
  formulate and fit geostatistical models using the maximum likelihood
  estimation method;
\item
  carry out prediction of health outcomes at different spatial scales;
\item
  visualize and interpret the results from geostatical models;
\item
  model the relationships between spatially referenced risk factors and
  the health outcome of interest;
\item
  validate geostatistical models.
\end{itemize}

Although the focus of this book is on public health, the statistical
ideas, as well as the software used, can also be applied for the
analysis of geostatistical data-sets arising from other scientific
fields.

\hypertarget{pre-requisites-for-using-this-book}{%
\section{Pre-requisites for using this
book}\label{pre-requisites-for-using-this-book}}

To effectively understand and use the material presented in this book,
it is expected that you should possess prior knowledge of basic
probability theory, foundational topics in statistical modelling and R
programming. Below we provide a more detailed explanation of the
pre-requisites for each of these three fields.

\hypertarget{topics-in-probability}{%
\subsection{Topics in probability}\label{topics-in-probability}}

Basics probability theory is important to fully understand the content
of this book. In particular, you should have knowledge of: the general
definition and properties of continuous and discrete distribution; how
the describe the properties of probability distributions through their
mean, variance and skeweness; the concepts of stochastic dependence and
correaltion; the distinction between marginal and conditional
distributions; the basic properties of the Gaussian, Binomial and
Poisson distributions; the definition and properties of the multivariate
Gaussian distribution. The redear can find an extensive explanation and
illustrations with examples of all these topics in Ross (2013).

\hypertarget{topics-in-statistics}{%
\subsection{Topics in statistics}\label{topics-in-statistics}}

Likelihood-based inference (whether frequensist or Bayesian) provides
the theoretical bedrock for the estimation of almost any statistical
model. In this book will focus on maximum likelihood estimation methods
of inference. Extensive use of the notions of point and interval
estimates obtained using the maximum likelihood estimation methods will
be made through the book. Recommended readings include chapters 1, 2 and
4 of Pawitan (2001).

Good knowledge of Generalized linear models (GLMs) is essential, as the
geostatistical modelling framework builds on these as an extension.
Before embarking on the use of this book, we thus encourage you to
review the basic theory of GLMs and, in particular, how these are
applied and interpreted. In this book, we will cover examples that will
model continuously measured outcomes and counts. Hence, good
understanding of linear regression modelling and modelling of counts
data using Binomial and Poisson regression should be the main focus of
the review. For comprehensive overview of GLMs and their implementation
in R, we refer you to Dobson and Barnett (2008).

\hypertarget{topics-in-r-programming}{%
\subsection{Topics in R programming}\label{topics-in-r-programming}}

Although this book does not require to possess advanced skills in R
programming, it is important you have good knowledge in the following
topics: creation and manipulation of vectors and matrices; logical
vectors; character vectors; handling of lists and data frame objects;
reading data into R; graphical procedures. A very large amount of freely
available material covering these topics can be found online. Our
recommendation is to start from the manual ``An introduction to R'' of
the Comprehensive R Archive Network available at this link, available at
\href{https://cran.r-project.org/manuals.html}{R manual}.

\hypertarget{obtaining-and-running-the-r-packages}{%
\section{Obtaining and running the R
packages}\label{obtaining-and-running-the-r-packages}}

It is advised that you obtain the latest 64-bit version of R in order to
run the R code of this book. To install R, go to the R website, where
you can download the installer packages for Windows and Mac, and find
instructions for Linux, using binary files.

\begin{itemize}
\tightlist
\item
  \href{https://cran.r-project.org/bin/windows/base/}{Windows}
\item
  \href{https://cran.r-project.org/bin/macosx}{Mac}
\item
  \href{https://cran.r-project.org/bin/linux}{Linux}
\end{itemize}

The list of R packages used in this book is provided in the table below.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.2727}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.7273}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
R package
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Used for
\end{minipage} \\
\midrule()
\endhead
\texttt{RiskMap} & Estimation of geostatistical model and spatial
prediction \\
\texttt{sf} & Handling of spatial data in R \\
\texttt{raster} & Handling of raster files in R \\
\texttt{ggplot2} & Creating maps \\
\bottomrule()
\end{longtable}

To install packages in R for the first time, you can use the command
\texttt{install.packages} in the R console, as shown below for the
\texttt{RiskMap} package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"RiskMap"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{examples}{%
\section{Examples}\label{examples}}

\hypertarget{workflow-of-a-statistical-analysis}{%
\section{Workflow of a statistical
analysis}\label{workflow-of-a-statistical-analysis}}

\bookmarksetup{startatroot}

\hypertarget{exploratory-analysis}{%
\chapter{Exploratory analysis}\label{exploratory-analysis}}

This is a book created from markdown and executable code.

See (\textbf{knuth84?}) for additional discussion of literate
programming.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\hypertarget{importing-and-processing-spatial-data-in-r}{%
\section{Importing and processing spatial data in
R}\label{importing-and-processing-spatial-data-in-r}}

\hypertarget{visualizing-geostatistical-data}{%
\section{Visualizing geostatistical
data}\label{visualizing-geostatistical-data}}

\hypertarget{exploring-associations}{%
\section{Exploring associations}\label{exploring-associations}}

\hypertarget{analysis-of-the-residuals}{%
\section{Analysis of the residuals}\label{analysis-of-the-residuals}}

\hypertarget{diagnostics-for-overdispersion}{%
\subsection{Diagnostics for
overdispersion}\label{diagnostics-for-overdispersion}}

\hypertarget{diagnostics-for-residual-spatial-variation}{%
\subsection{Diagnostics for residual spatial
variation}\label{diagnostics-for-residual-spatial-variation}}

\bookmarksetup{startatroot}

\hypertarget{model-fitting}{%
\chapter{Model fitting}\label{model-fitting}}

This is a book created from markdown and executable code.

See (\textbf{knuth84?}) for additional discussion of literate
programming.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\hypertarget{linear-gaussian-model}{%
\section{Linear Gaussian model}\label{linear-gaussian-model}}

\hypertarget{generalized-linear-geostatistical-models}{%
\section{Generalized linear geostatistical
models}\label{generalized-linear-geostatistical-models}}

\bookmarksetup{startatroot}

\hypertarget{model-validation}{%
\chapter{Model validation}\label{model-validation}}

This is a book created from markdown and executable code.

See (\textbf{knuth84?}) for additional discussion of literate
programming.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\hypertarget{how-to-simulate-geostatistical-data-from-a-fitted-model}{%
\section{How to simulate geostatistical data from a fitted
model}\label{how-to-simulate-geostatistical-data-from-a-fitted-model}}

\hypertarget{validating-the-calibration-of-the-model}{%
\section{Validating the calibration of the
model}\label{validating-the-calibration-of-the-model}}

\hypertarget{validating-the-spatial-correlation-of-the-model}{%
\section{Validating the spatial correlation of the
model}\label{validating-the-spatial-correlation-of-the-model}}

\bookmarksetup{startatroot}

\hypertarget{geostatistical-prediction}{%
\chapter{Geostatistical prediction}\label{geostatistical-prediction}}

This is a book created from markdown and executable code.

See (\textbf{knuth84?}) for additional discussion of literate
programming.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\hypertarget{pixel-level-predictive-targets}{%
\section{Pixel-level predictive
targets}\label{pixel-level-predictive-targets}}

\hypertarget{area-level-predictive-targets}{%
\section{Area-level predictive
targets}\label{area-level-predictive-targets}}

\hypertarget{comparing-the-predictive-performance-of-geostatistical-models}{%
\section{Comparing the predictive performance of geostatistical
models}\label{comparing-the-predictive-performance-of-geostatistical-models}}

\bookmarksetup{startatroot}

\hypertarget{case-studies}{%
\chapter{Case studies}\label{case-studies}}

This is a book created from markdown and executable code.

See (\textbf{knuth84?}) for additional discussion of literate
programming.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\hypertarget{mapping-stunting-risk-in-ghan}{%
\section{Mapping stunting risk in
Ghan}\label{mapping-stunting-risk-in-ghan}}

\hypertarget{mapping-river-blindness-in-malawi}{%
\section{Mapping river blindness in
Malawi}\label{mapping-river-blindness-in-malawi}}

\hypertarget{mapping-mosquitoes-abundance-in-cameroon}{%
\section{Mapping mosquitoes abundance in
Cameroon}\label{mapping-mosquitoes-abundance-in-cameroon}}

\bookmarksetup{startatroot}

\hypertarget{references}{%
\chapter*{References}\label{references}}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-diggleBook2019}{}}%
Diggle, Peter J. 2019. \emph{Model-Based Geostatistics for Global Public
Health : Methods and Applications.} Chapman and Hall/CRC
Interdisciplinary Statistics Ser. Milton: Chapman; Hall/CRC.

\leavevmode\vadjust pre{\hypertarget{ref-dobson2008}{}}%
Dobson, A. J., and A. Barnett. 2008. \emph{An Introduction to
Generalized Linear Models}. Third. Chapman; Hall/CRC.

\leavevmode\vadjust pre{\hypertarget{ref-pawitan2001}{}}%
Pawitan, Yudi. 2001. \emph{In All Likelihood : Statistical Modelling and
Inference Using Likelihood}. Oxford ; New York: Clarendon Press : Oxford
University Press.

\leavevmode\vadjust pre{\hypertarget{ref-ross2013}{}}%
Ross, Sheldon. 2013. \emph{First Course in Probability, a.} 9th ed.
Harlow: Pearson Education UK.

\end{CSLReferences}



\end{document}
